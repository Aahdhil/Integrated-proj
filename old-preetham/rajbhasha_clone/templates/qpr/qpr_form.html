{% extends "master.html" %}
{% load static %}
{% load translate_tags %}

{% block title %}{{ "Quarterly Progress Report"|t:current_lang }}{% endblock %}

{% block extra_css %}
<style>
    .bg-header {
        background-color: #f8f9fa;
        border-bottom: 1px solid #dee2e6;
    }

    .part-badge {
        background-color: #6c757d;
        color: white;
        padding: 5px 10px;
        border-radius: 4px;
        font-size: 0.9rem;
    }

    .section-title {
        font-weight: bold;
        margin-bottom: 15px;
        border-bottom: 2px solid #eee;
        padding-bottom: 10px;
        color: #2c5a86;
    }

    .section-box {
        margin-bottom: 20px;
        padding: 15px;
        background: #f9f9f9;
        border-radius: 8px;
        border: 1px solid #e9ecef;
    }

    .lbl-row {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
    }

    .lbl-text {
        flex: 1;
        padding-right: 10px;
        font-size: 0.95rem;
    }

    .lbl-input {
        width: 100px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container my-4">

    <div class="card shadow-sm mb-4">
        <div
            class="card-header bg-header py-3 d-flex flex-column flex-md-row align-items-md-center justify-content-between">
            <h5 class="mb-0">{{ "Quarterly Progress Report"|t:current_lang }}</h5>
            <div class="d-flex align-items-center gap-3">
                <div id="partBadge" class="part-badge">{{ "Part-1"|t:current_lang }}</div>
            </div>
        </div>

        <div class="card-body">
            <form id="qprForm">
                {% csrf_token %}
                <input type="hidden" id="recordId">

                <div id="tab1">

                    <div class="general-info">
                        <div class="row g-2 align-items-center mb-2">
                            <div class="col-md-3 text-end">{{ "Quarter Ending"|t:current_lang }}</div>
                            <div class="col-md-3">
                                <select class="form-select form-select-sm" id="quarter">
                                    <option>{{ "Dec 31"|t:current_lang }}</option>
                                    <option>{{ "Mar 31"|t:current_lang }}</option>
                                    <option>{{ "Jun 30"|t:current_lang }}</option>
                                    <option>{{ "Sep 30"|t:current_lang }}</option>
                                </select>
                            </div>
                            <div class="col-md-2"><select class="form-select form-select-sm" id="year">
                                    <option>{{ "Loading..."|t:current_lang }}</option>
                                </select></div>
                        </div>
                        <div class="row g-2 align-items-center mb-2">
                            <div class="col-md-3 text-end">{{ "Name of Office"|t:current_lang }}</div>
                            <div class="col-md-5"><input type="text" class="form-control form-control-sm"
                                    id="officeName"></div>
                        </div>
                        <div class="row g-2 align-items-center mb-2">
                            <div class="col-md-3 text-end">{{ "Office Code"|t:current_lang }}</div>
                            <div class="col-md-5"><input type="text" class="form-control form-control-sm"
                                    id="officeCode"></div>
                        </div>
                        <div class="row g-2 align-items-center mb-2">
                            <div class="col-md-3 text-end">{{ "Phone No."|t:current_lang }}</div>
                            <div class="col-md-5"><input type="text" class="form-control form-control-sm" id="phone">
                            </div>
                        </div>
                        <div class="row g-2 align-items-center mb-2">
                            <div class="col-md-3 text-end">{{ "Language Region"|t:current_lang }}</div>
                            <div class="col-md-5">
                                <select class="form-select form-select-sm" id="region">
                                    <option>{{ "Region A"|t:current_lang }}</option>
                                    <option>{{ "Region B"|t:current_lang }}</option>
                                    <option>{{ "Region C"|t:current_lang }}</option>
                                </select>
                            </div>
                        </div>
                        <div class="row g-2 align-items-center">
                            <div class="col-md-3 text-end">{{ "Email ID"|t:current_lang }}</div>
                            <div class="col-md-5"><input type="email" class="form-control form-control-sm" id="email">
                            </div>
                        </div>
                    </div>
                    <hr>

                    <div class="row">
                        <div class="col-md-6 section-box">
                            <div class="section-title">1. {{ "Details Of Files Sent To The Minister"|t:current_lang }}
                            </div>

                            <div class="lbl-row">
                                <div class="lbl-text">{{ "Total No. Files Sent To The Minister During Quarter"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s1_total"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text"> {{"Out of these, no.of files sent to in Hindi"|t:current_lang }} </div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm" id="s1_hindi"></div>
                            </div>
                        </div>

                        <div class="col-md-6 section-box">
                            <div class="section-title">2. {{ "Details of meetings/files at Secretary/Equivalent level"|t:current_lang }}</div>

                            <div class="lbl-row">
                                <div class="lbl-text">{{ "How many meetings were held at Secretary/equivalent"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s2_meetings"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "Meetings were conducted in Hindi/Minutes were published in Hindi"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm" id="s2_minutes"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "Total papers issued directly from Secretary/equivalent"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm" id="s2_papers_total"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "Total documents issued in Hindi"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm" id="s2_papers_hindi"></div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 section-box">
                            <div class="section-title">3. {{ "Documents issued under Section 3(3) of the Official Languages Act, 1963"|t:current_lang }}</div>

                            <div class="lbl-row">
                                <div class="lbl-text">{{ "Total no. of documents issued"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s3_total"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "Total No. of documents issued bilingually"|t:current_lang }}
                                </div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s3_bilingual"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "No. of documents issued only in English"|t:current_lang }}
                                </div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s3_english"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "No. of documents issued only in Hindi"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s3_hindi_only"></div>
                            </div>
                        </div>

                        <div class="col-md-6 section-box">
                            <div class="section-title">4. {{ "Letters received in Hindi (Official Language Rule-5)"|t:current_lang }}</div>

                            <div class="lbl-row">
                                <div class="lbl-text">{{ "Total no.of letters received in Hindi"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s4_total"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "No. of letters not to be replied to"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s4_no_reply"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "Out of these, no.of letters replied to in Hindi"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s4_replied_hindi"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "Total no.of letters replied in English"|t:current_lang }}
                                </div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s4_replied_eng"></div>
                            </div>
                        </div>
                    </div>

                    <div class="text-end mt-4">
                        <button type="button" class="btn btn-primary" onclick="showTab(2)">{{ "Next"|t:current_lang }}
                            &rarr;</button>
                    </div>
                </div>

                <div id="tab2" class="d-none">
                    <div class="row">
                        <div class="col-md-6 section-box">
                            <div class="section-title">5. {{ "No.of letters received in English but replied in Hindi/For A and B Region"|t:current_lang }}</div>

                            <p class="text-center fw-bold mb-2 small">{{ "From Region 'A'"|t:current_lang }}</p>

                            <div class="lbl-row">
                                <div class="lbl-text">{{ "No.of letters received in English"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s5_total"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "No.of letters replied in Hindi"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s5_hindi"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "How Many letters replied against these inEnglish"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s5_english"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "No. of letters not expected to be replied"|t:current_lang }}
                                </div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s5_noreply"></div>
                            </div>
                        </div>

                        <div class="col-md-6 section-box">
                            <div class="section-title">6. {{ "Details of total letters issued"|t:current_lang }}</div>

                            <div class="mb-3 border-bottom pb-2">
                                <strong class="d-block text-center text-primary mb-2 small">{{ "To Region 'A'"|t:current_lang }}</strong>
                                <div class="lbl-row">
                                    <div class="lbl-text small">{{ "Issued in Hindi/Bilingual"|t:current_lang }}</div>
                                    <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                            id="s6_a_hindi"></div>
                                </div>
                                <div class="lbl-row">
                                    <div class="lbl-text small">{{ "Issued in English only"|t:current_lang }}</div>
                                    <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                            id="s6_a_eng"></div>
                                </div>
                                <div class="lbl-row">
                                    <div class="lbl-text small">{{ "Total no.of letters issued"|t:current_lang }}</div>
                                    <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                            id="s6_a_total"></div>
                                </div>
                            </div>

                            <div class="mb-3 border-bottom pb-2">
                                <strong class="d-block text-center text-primary mb-2 small">{{ "To Region 'B'"|t:current_lang }}</strong>
                                <div class="lbl-row">
                                    <div class="lbl-text small">{{ "Issued in Hindi/Bilingual"|t:current_lang }}</div>
                                    <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                            id="s6_b_hindi"></div>
                                </div>
                                <div class="lbl-row">
                                    <div class="lbl-text small">{{ "Issued in English only"|t:current_lang }}</div>
                                    <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                            id="s6_b_eng"></div>
                                </div>
                                <div class="lbl-row">
                                    <div class="lbl-text small">{{ "Total no.of letters Issued"|t:current_lang }}</div>
                                    <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                            id="s6_b_total"></div>
                                </div>
                            </div>

                            <div>
                                <strong class="d-block text-center text-primary mb-2 small">{{ "To Region 'C'"|t:current_lang }}</strong>
                                <div class="lbl-row">
                                    <div class="lbl-text small">{{ "Issued in Hindi/Bilingual"|t:current_lang }}</div>
                                    <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                            id="s6_c_hindi"></div>
                                </div>
                                <div class="lbl-row">
                                    <div class="lbl-text small">{{ "Issued in English only"|t:current_lang }}</div>
                                    <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                            id="s6_c_eng"></div>
                                </div>
                                <div class="lbl-row">
                                    <div class="lbl-text small">{{ "Total no.of letters issued"|t:current_lang }}</div>
                                    <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                            id="s6_c_total"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 section-box">
                            <div class="section-title">7. {{ "Details of Notings on files/documents"|t:current_lang }}
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "No. of pages with Notings in Hindi"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s7_hindi"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "No. of pages with Notings in English"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s7_eng"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "No. of pages of total Notings"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s7_total"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "Details of comments sent through e-office"|t:current_lang }}
                                </div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s7_eoffice"></div>
                            </div>
                        </div>

                        <div class="col-md-6 section-box">
                            <div class="section-title">8. {{ "Hindi Workshops in this Quarter"|t:current_lang }}</div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "No. of full day workshops conducted during the quarter"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s8_workshops"></div>
                            </div>
                            <hr class="my-3">
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "No. of Officers trained"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s8_officers"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "No. of employees trained"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s8_employees"></div>
                            </div>
                        </div>
                    </div>


                    <div class="d-flex justify-content-between mt-4">
                        <button type="button" class="btn btn-secondary" onclick="showTab(1)">&larr; {{"Previous"|t:current_lang }}</button>
                        <button type="button" class="btn btn-primary" onclick="showTab(3)">{{ "Next"|t:current_lang }}
                            &rarr;</button>
                    </div>
                </div>

                <div id="tab3" class="d-none">

                    <div class="row">
                        <div class="col-md-6 section-box">
                            <div class="section-title">9. {{ "Date of the meeting of the Departmental/Organizational Official Language Implementation Committee"|t:current_lang }}</div>

                            <div class="lbl-row">
                                <div class="lbl-text">{{ "Date of the meeting of Official Language Implementation Committee"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="date" class="form-control form-control-sm"
                                        id="s9_date"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "No. Of Official Language Implementation Committee constituted in subordinate offices"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s9_sub_committees"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "No. of Meetings organized in this quarter"|t:current_lang }}
                                </div>
                                <div class="lbl-input"><input type="number" class="form-control form-control-sm"
                                        id="s9_meetings_count"></div>
                            </div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "Whether the agenda or the minutes of the meeting were issued in Hindi ?"|t:current_lang }}</div>
                                <div class="lbl-input">
                                    <select class="form-select form-select-sm" id="s9_agenda_hindi">
                                        <option>{{ "Yes"|t:current_lang }}</option>
                                        <option>{{ "No"|t:current_lang }}</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6 section-box">
                            <div class="section-title">10. {{ "Date of the Meeting of the Hindi Advisory Committee"|t:current_lang }}</div>
                            <div class="lbl-row">
                                <div class="lbl-text">{{ "Date"|t:current_lang }}</div>
                                <div class="lbl-input"><input type="date" class="form-control form-control-sm"
                                        id="s10_date"></div>
                            </div>
                        </div>
                    </div>

                    <div class="section-box">
                        <div class="section-title">11. {{ "specific achievements during quarter"|t:current_lang }}</div>

                        <div class="mb-2">
                            <textarea class="form-control" id="s12_1"
                                placeholder="{{ '1. Innovative Work'|t:current_lang }}"></textarea>
                        </div>
                        <div class="mb-2">
                            <textarea class="form-control" id="s12_2"
                                placeholder="{{ '2. Special Event/Notable Work'|t:current_lang }}"></textarea>
                        </div>
                        <div class="mb-2">
                            <textarea class="form-control" id="s12_3"
                                placeholder="{{ '3. Other works done in Hindi medium'|t:current_lang }}"></textarea>
                        </div>
                    </div>

                    <div class="d-flex justify-content-between mt-4 pt-3 border-top">
                        <button type="button" class="btn btn-secondary" onclick="showTab(2)">&larr;
                            {{"Previous"|t:current_lang }}</button>
                        <div>
                            <button type="button" class="btn btn-info text-white me-2"
                                onclick="saveData('Draft')">{{"Save as Draft"|t:current_lang }}</button>
                            <button type="button" class="btn btn-primary" style="background-color: #2c5a86;"
                                onclick="saveData('Submitted')">{{ "Submit to HOD"|t:current_lang }}</button>
                        </div>
                    </div>
                </div>

            </form>
        </div>
    </div>

    <div class="card shadow-sm mt-5">
        <div class="card-body text-center">
            <a href="{% url 'qpr_report_list' %}" class="btn btn-outline-primary">{{ "Report List"|t:current_lang }}</a>
        </div>
    </div>
</div>

<button id="hindiToggle" class="btn btn-outline-secondary btn-sm">{{ "Hindi Keyboard"|t:current_lang }}</button>
<div id="hindiKeyboard"></div>

<script>
    // Immediately populate year dropdown on page load
    function initYearDropdown() {
        const yearSelect = document.getElementById('year');
        if (!yearSelect) {
            setTimeout(initYearDropdown, 100);
            return;
        }

        const currentDate = new Date();
        const currentMonth = currentDate.getMonth();
        const currentYear = currentDate.getFullYear();

        let fiscalYearStart = currentMonth < 3 ? currentYear - 1 : currentYear;
        let fiscalYearEnd = fiscalYearStart + 1;

        yearSelect.innerHTML = '';

        const startYear = 2000;
        const endYear = new Date().getFullYear() + 50; // Current year + 50 years ahead

        for (let year = startYear; year <= endYear; year++) {
            const option = document.createElement('option');
            option.value = `${year}-${year + 1}`;
            option.textContent = `${year}-${year + 1}`;
            yearSelect.appendChild(option);
        }

        yearSelect.value = `${fiscalYearStart}-${fiscalYearEnd}`;
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initYearDropdown);
    } else {
        initYearDropdown();
    }
</script>

<script src="{% static 'js/script.js' %}"></script>
{% endblock %}